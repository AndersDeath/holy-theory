<!DOCTYPE html>
  <html lang="en">
  <head>
      <meta charset="UTF-8">
      <meta name="viewport" content="width=device-width, initial-scale=1.0">
      <title>Holy Theory</title>
      <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/styles/monokai.min.css" />
      <script type="application/javascript" src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/highlight.min.js"></script>
      <style>
      body {
        margin: 0;
            padding: 0;
        }

        img {
            max-width: 400px;
        }

        .content {
          width: 60%;
          margin: 0 auto;
        }
      </style>
  </head>
  <body>
      <div class="content"><h1 id="count-complete-tree-nodes">Count Complete Tree Nodes</h1>
<pre><code class="hljs language-typescript"><span class="hljs-comment">/**
 * Definition for a binary tree node.
 * class TreeNode {
 *     val: number
 *     left: TreeNode | null
 *     right: TreeNode | null
 *     constructor(val?: number, left?: TreeNode | null, right?: TreeNode | null) {
 *         this.val = (val===undefined ? 0 : val)
 *         this.left = (left===undefined ? null : left)
 *         this.right = (right===undefined ? null : right)
 *     }
 * }
 */</span>


<span class="hljs-keyword">function</span> <span class="hljs-title function_">countNodes</span>(<span class="hljs-params">root: <span class="hljs-built_in">any</span> | <span class="hljs-literal">null</span></span>): <span class="hljs-built_in">number</span> {
  <span class="hljs-keyword">if</span> (!root) {
    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
  }

  <span class="hljs-keyword">const</span> leftDepth = <span class="hljs-title function_">getLeftDepth</span>(root);
  <span class="hljs-keyword">const</span> rightDepth = <span class="hljs-title function_">getRightDepth</span>(root);

  <span class="hljs-keyword">if</span> (leftDepth === rightDepth) {
    <span class="hljs-comment">// If the left and right subtrees have the same depth, the tree is complete.</span>
    <span class="hljs-keyword">return</span> <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">pow</span>(<span class="hljs-number">2</span>, leftDepth) - <span class="hljs-number">1</span>;
  }

  <span class="hljs-comment">// If the left and right subtrees have different depths, recursively count nodes.</span>
  <span class="hljs-keyword">return</span> <span class="hljs-number">1</span> + <span class="hljs-title function_">countNodes</span>(root.<span class="hljs-property">left</span>) + <span class="hljs-title function_">countNodes</span>(root.<span class="hljs-property">right</span>);
}

<span class="hljs-keyword">function</span> <span class="hljs-title function_">getLeftDepth</span>(<span class="hljs-params">node: <span class="hljs-built_in">any</span> | <span class="hljs-literal">null</span></span>): <span class="hljs-built_in">number</span> {
  <span class="hljs-keyword">let</span> depth = <span class="hljs-number">0</span>;
  <span class="hljs-keyword">while</span> (node) {
    depth++;
    node = node.<span class="hljs-property">left</span>;
  }
  <span class="hljs-keyword">return</span> depth;
}

<span class="hljs-keyword">function</span> <span class="hljs-title function_">getRightDepth</span>(<span class="hljs-params">node: <span class="hljs-built_in">any</span> | <span class="hljs-literal">null</span></span>): <span class="hljs-built_in">number</span> {
  <span class="hljs-keyword">let</span> depth = <span class="hljs-number">0</span>;
  <span class="hljs-keyword">while</span> (node) {
    depth++;
    node = node.<span class="hljs-property">right</span>;
  }
  <span class="hljs-keyword">return</span> depth;
}
</code></pre><p><strong>Solution:</strong>
This code defines a function <code>countNodes</code> to count the total number of nodes in a binary tree. The binary tree is represented using the <code>TreeNode</code> class, which has a <code>val</code> property for the node value and <code>left</code> and <code>right</code> properties for the left and right child nodes.</p>
<p>Breakdown:</p>
<ol>
<li><p><strong><code>countNodes</code> Function:</strong></p>
<ul>
<li>The function takes a binary tree&#39;s root node as an argument (<code>root: TreeNode | null</code>).</li>
<li>If the tree is empty (i.e., <code>root</code> is <code>null</code>), it returns 0.</li>
<li>It then calculates the depth of the left and right subtrees using the helper functions <code>getLeftDepth</code> and <code>getRightDepth</code>.</li>
<li>If the left and right subtrees have the same depth, the tree is complete, and it returns the total number of nodes using the formula (2^{\text{leftDepth}} - 1).</li>
<li>If the left and right subtrees have different depths, it recursively counts nodes in the left and right subtrees and adds 1 for the current node.</li>
</ul>
</li>
<li><p><strong><code>getLeftDepth</code> and <code>getRightDepth</code> Helper Functions:</strong></p>
<ul>
<li>These functions take a node as an argument and return the depth of the left or right subtree, respectively.</li>
<li>They use a while loop to traverse the tree and count the depth by moving to the left or right child nodes until reaching the deepest node.</li>
</ul>
</li>
</ol>
<p>The overall logic of the code is based on the observation that in a complete binary tree, if the left and right subtrees have the same depth, then the tree is complete, and the total number of nodes can be calculated directly. Otherwise, it recursively counts nodes in the left and right subtrees.</p>
</div>
  </body>
  </html>